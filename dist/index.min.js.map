{"version":3,"file":"index.min.js","sources":["../src/path.js","../src/query.js","../src/utils.js","../src/route.js","../src/router-mixin.js","../src/router-link.js","../src/router.js"],"sourcesContent":["const MATCH_ALL = '[^/]*';\r\n\r\nconst CATCH_ALL = '([^/]+)';\r\n\r\nconst PARAMETER_PATTERN = /:([^\\/]+)/;\r\n\r\n// optional trailing slash\r\n// only matches the slash if nothing follows\r\nconst MATCH_TRAILING_SLASH = '(?:[\\/]?(?=$))?';\r\n\r\n// implements '**' as a wildcard\r\nconst WILDCARD_PATTERN = /\\*\\*/g;\r\n\r\nexport class Path {\r\n  /**\r\n   * \r\n   * @param {String} input The path to compile\r\n   * @param {Boolean} exact Whether or not the pattern should match anything after the path\r\n   */\r\n  constructor(path, exact = false) {\r\n    // replace any wildcards with\r\n    // their corresponding expression\r\n    path = path.replace(WILDCARD_PATTERN, MATCH_ALL);\r\n    \r\n    let match;\r\n    let keys = [];\r\n    // convert :param to a catch-all group\r\n    // and save the keys\r\n    while ((match = PARAMETER_PATTERN.exec(path)) != null) {\r\n      path = path.replace(match[0], CATCH_ALL);\r\n      keys.push(match[1]);\r\n    }\r\n\r\n    if (!path.endsWith('/')) {\r\n      path += MATCH_TRAILING_SLASH;\r\n    }\r\n\r\n    path = exact ? `^${path}$` : `^${path}`;\r\n    const pattern = new RegExp(path, 'i');\r\n\r\n    this.pattern = pattern;\r\n    this.keys = keys;\r\n  }\r\n\r\n  /**\r\n   * Convenience function that mirrors RegExp.test\r\n   * @param {String} path\r\n   * @return {Boolean} \r\n   */\r\n  matches(path) {\r\n    return this.pattern.test(path);\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param {String} path Path to match against.\r\n   * @return {String} Matched portion of the path. \r\n   */\r\n  matched(path) {\r\n    return this.pattern.exec(path)[0];\r\n  }\r\n\r\n  /**\r\n   * @param {String} url The path to get values from\r\n   * @return {ParsedExpression} A collection of functions for working with the url\r\n   */\r\n  parse(url) {\r\n    return new ParsedExpression(\r\n      url,\r\n      this.pattern,\r\n      this.keys\r\n    );\r\n  }\r\n\r\n  /**\r\n   * \r\n   * @param {String} target A path, potentially with unresolved parameters \r\n   * @param {String} current The path that was matched\r\n   * @return {String} The target path with parameters filled in\r\n   */\r\n  transfer(current, target) {\r\n    const values = this.pattern.exec(current).slice(1);\r\n    let transferred = target;\r\n\r\n    let i = values.length;\r\n    while (i--) {\r\n      transferred = transferred\r\n        .replace(':' + this.keys[i], values[i]);\r\n    }\r\n\r\n    return transferred;\r\n  }\r\n}\r\n\r\nclass ParsedExpression {\r\n  constructor(url, pattern, keys) {\r\n    this.values = pattern.exec(url).slice(1);\r\n    this.url = url;\r\n    this.keys = keys;\r\n    this.map = new Map();\r\n  }\r\n\r\n  get(key) {\r\n    return this.values[this.keys.indexOf(key)];\r\n  }\r\n\r\n  set(key, value) {\r\n    return this.url.replace(this.get(key), value);\r\n  }\r\n\r\n  has(key) {\r\n    return this.get(key) !== undefined;\r\n  }\r\n\r\n  all() {\r\n    return this.keys.reduce((entries, key, i) => {\r\n      entries[key] = this.values[i];\r\n      return entries;\r\n    }, {});\r\n  }\r\n\r\n  entries() {\r\n    return this.keys.map(key => [key, this.get(key)]);\r\n  }\r\n\r\n  *[Symbol.iterator]() {\r\n    const length = this.keys.length;\r\n    for (let i = 0; i < length; i++) {\r\n      yield [this.keys[i], this.values[i]];\r\n    }\r\n  }\r\n}\r\n\r\nexport default Path;","export class Query extends Map {\r\n  static from(object) {\r\n    return new Query(Object.entries(object));\r\n  }\r\n\r\n  static of(...pairs) {\r\n    return new Query(pairs);\r\n  }\r\n\r\n  static parse(string) {\r\n    if (string.startsWith('?')) {\r\n      string = string.substring(1);\r\n    }\r\n\r\n    let entries = [];\r\n    if (string !== '') {\r\n      entries = string.split('&')\r\n        .map((substring) => substring.split('='));\r\n    }\r\n\r\n    return new Query(entries);\r\n  }\r\n\r\n  toString() {\r\n    let string = '';\r\n    for (const [key, value] of this) {\r\n      string += `&${key}=${value}`;\r\n    }\r\n    return string.substring(1);\r\n  }\r\n}","/**\r\n * Append a leading slash, and remove all excess slashes.\r\n * @param {string} path\r\n * @returns {string}\r\n */\r\nexport function normalize(path) {\r\n  return ('/' + path).replace(/[\\/]+/g, '/');\r\n}\r\n\r\n/**\r\n * Determines if the given object is a callable function.\r\n * An ES2015 class will return false, while ordinary functions,\r\n * arrow functions, generator functions and async functions return true.\r\n * @param {object} object the object that is to be inspected\r\n * @returns {boolean}\r\n */\r\nexport function isFunction(object) {\r\n  if (!(typeof object === 'function')) {\r\n    return false;\r\n  }\r\n\r\n  /**\r\n   * Truthiness matrix for `hasOwnProperty` on functions:\r\n   * \r\n   *           | Class | Ordinary | Arrow | Async | Generator |\r\n   * ---------------------------------------------------------|\r\n   * arguments | false |   true   | false | false |   false   |\r\n   * prototype | true  |   true   | false | false |   true    |\r\n   * \r\n   */\r\n\r\n  const tag = object[Symbol.toStringTag];\r\n  // First it is determined if it's an async or generator function.\r\n  // Generator functions and classes have the same properties,\r\n  // so using the tag is needed.\r\n  // An async function can also be identified with this method, so it\r\n  // is also done here for convenience.\r\n  // Ordinary functions, arrow functions and classes cannot be identified\r\n  // with this method.\r\n  if (tag === 'AsyncFunction' || tag === 'GeneratorFunction') {\r\n    return true;\r\n  } else {\r\n    // Ordinary functions have an `arguments` property, which classes do not.\r\n    const isNormalFunction = object.hasOwnProperty('arguments');\r\n    // Arrow functions do not have a `prototype` property, which classes do.\r\n    const isArrowFunction = !object.hasOwnProperty('prototype');\r\n    return isNormalFunction || isArrowFunction;\r\n  }\r\n}\r\n\r\nexport function isPromise(object) {\r\n  return object[Symbol.toStringTag] === 'Promise';\r\n}\r\n\r\nconst components = new WeakMap();\r\n\r\n/**\r\n * Resolve an identifier to a class.\r\n * @param {Promise|Function|String} component The identifier\r\n * @param {Function} callback\r\n */\r\nexport function load(component, callback) {\r\n  if (typeof component === 'string') {\r\n    // If it's a string, assume that it has\r\n    // been defined, and return the class\r\n    // associated with the tag to allow\r\n    // uniform callback function signature.\r\n    callback(customelements.get(component));\r\n\r\n  } else if (components.has(component)) {\r\n    // If it has been resolved before,\r\n    // return the resolved value.\r\n    callback(components.get(component));\r\n\r\n  } else if (isFunction(component)) {\r\n    // If it's a function, call it.\r\n    let called = component();\r\n    if (isPromise(called)) {\r\n      // If the function returns a promise,\r\n      // assume that it is a module and assume\r\n      // the component is the default export.\r\n      called.then((m) => {\r\n        components.set(component, m.default);\r\n        callback(m.default);\r\n      });\r\n    } else {\r\n      // If the function call returned something\r\n      // that isn't a promise, assume that it returned\r\n      // a component directly.\r\n      components.set(component, called);\r\n      callback(called);\r\n    }\r\n  } else {\r\n    callback(component);\r\n  }\r\n}\r\n","import { Path } from './path.js';\r\nimport { Query } from './query.js';\r\nimport { load, normalize } from './utils.js';\r\n\r\nexport class Route extends Path {\r\n  constructor({ path, exact, component, meta, children }) {\r\n    super(path, exact);\r\n    this.path = path;\r\n    this.meta = meta;\r\n    this.component = component;\r\n    this.children = children;\r\n  }\r\n\r\n  async import() {\r\n    return new Promise((resolve) => {\r\n      load(this.component, (Component) => resolve(Component));\r\n    });\r\n  }\r\n}\r\n\r\nexport class Routes {\r\n  constructor(records) {\r\n    this.routes = records.map(record => this.define(record));\r\n  }\r\n\r\n  define(record, parent) {\r\n    if (parent != null) {\r\n      record.path = normalize(parent.path + '/' + record.path);\r\n    }\r\n\r\n    if (record.children != null) {\r\n      record.children = record.children\r\n        .map(child => this.define(child, record));\r\n    } else {\r\n      record.exact = true;\r\n    }\r\n    \r\n    return new Route(record);\r\n  }\r\n\r\n  [Symbol.iterator]() {\r\n    return this.routes[Symbol.iterator]();\r\n  }\r\n}\r\n\r\nexport class ActiveRoute {\r\n  constructor(route, url) {\r\n    this.parameters = route.parse(url);\r\n    this.matched = route.matched(url);\r\n    this.query = Query.parse(url);\r\n    this.hash = location.hash.substring(1);\r\n  }\r\n}","export const RouterMixin = (SuperClass) => (class extends SuperClass {\r\n  constructor() {\r\n    super();\r\n    this.router = window.Router;\r\n  }\r\n\r\n  connectedCallback() {\r\n    const root = this.getRootNode();\r\n    const host = root.host;\r\n    if (host && host.route) {\r\n      this.route = host.route;\r\n    }\r\n    if (super.connectedCallback) {\r\n      super.connectedCallback();\r\n    }\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    if (super.disconnectedCallback) {\r\n      super.disconnectedCallback();\r\n    }\r\n  }\r\n});","import { RouterMixin } from './router-mixin.js';\r\n\r\nexport class RouterLinkElement extends RouterMixin(HTMLElement) {\r\n  constructor() {\r\n    super();\r\n    this.onClick = this.onClick.bind(this);\r\n  }\r\n\r\n  set to(v) {\r\n    this.setAttribute('to', v);\r\n  }\r\n\r\n  get to() {\r\n    return this.getAttribute('to');\r\n  }\r\n\r\n  set exact(v) {\r\n    this.toggleAttribute('exact', v);\r\n  }\r\n\r\n  get exact() {\r\n    return this.hasAttribute('exact');\r\n  }\r\n\r\n  set active(v) {\r\n    this.toggleAttribute('active', v);\r\n  }\r\n\r\n  get active() {\r\n    return this.hasAttribute('active');\r\n  }\r\n\r\n  set disabled(v) {\r\n    this.toggleAttribute('disabled', v);\r\n  }\r\n\r\n  get disabled() {\r\n    return this.hasAttribute('disabled');\r\n  }\r\n\r\n  connectedCallback() {\r\n    super.connectedCallback();\r\n    this.addEventListener('click', this.onClick);\r\n    addEventListener('location-change', this.onChange);\r\n  }\r\n\r\n  disconnectedCallback() {\r\n    removeEventListener('location-change', this.onChange);\r\n    super.disconnectedCallback();\r\n  }\r\n\r\n  onClick() {\r\n    if (this.disabled) {\r\n      return;\r\n    } else {\r\n      this.router.push(this.href);\r\n    }\r\n  }\r\n\r\n  onChange(event) {\r\n    const url = decodeURIComponent(location.pathname);\r\n    if (this.href.startsWith('/')) {\r\n      this.active = this.exact\r\n        ? url === this.href\r\n        : url.startsWith(this.href);\r\n    } else {\r\n      this.active = url.endsWith(this.href);\r\n    }\r\n  }\r\n}\r\n\r\nexport default RouterLinkElement;","import { Routes, ActiveRoute } from './route.js';\r\n\r\nconst EMPTY = Object.create(null);\r\n\r\nexport class Router {\r\n  constructor(records, target) {\r\n    console.time('new Router');\r\n    this.views = [];\r\n    this.routes = [];\r\n    this.view = null;\r\n    this.target = target;\r\n    this.routes = new Routes(records);\r\n\r\n    window.addEventListener('popstate', () => {\r\n      const url = decodeURIComponent(location.pathname);\r\n      const matched = this.resolve(url);\r\n      this.render(matched, url);\r\n    });\r\n\r\n    window.Router = this;\r\n\r\n    const url = decodeURIComponent(location.pathname);\r\n    const matched = this.resolve(url);\r\n    console.timeEnd('new Router');\r\n    this.render(matched, url);\r\n  }\r\n\r\n  push(url, { data, title } = EMPTY) {\r\n    history.pushState(data, title, url);\r\n    const path = decodeURIComponent(location.pathname);\r\n    const matched = this.resolve(path);\r\n    this.render(matched, path);\r\n  }\r\n\r\n  replace(url, { data, title } = EMPTY) {\r\n    history.replaceState(data, title, url);\r\n    const path = decodeURIComponent(location.pathname);\r\n    const matched = this.resolve(path);\r\n    this.render(matched, path);\r\n  }\r\n\r\n  resolve(url) {\r\n    let matched = [];\r\n    const flatten = (route) => {\r\n      let matches = route.matches(url);\r\n      if (matches) {\r\n        matched.push(route);\r\n        if (route.children != null) {\r\n          for (const child of route.children) {\r\n            flatten(child);\r\n          }\r\n        }\r\n      }\r\n      return matches;\r\n    }\r\n\r\n    for (const route of this.routes) {\r\n      if (flatten(route)) {\r\n        break;\r\n      }\r\n    }\r\n\r\n    return matched;\r\n  }\r\n\r\n  async render(matched, url) {\r\n    console.time('render');\r\n    console.time('import');\r\n    const components = await Promise.all(\r\n      matched.map(route => route.import())\r\n    );\r\n    console.timeEnd('import');\r\n\r\n    let parent;\r\n    const length = matched.length;\r\n    for (let i = 0; i < length; i++) {\r\n      const route = matched[i];\r\n      // A view is an existing component from a previous render\r\n      const view = this.views[i];\r\n      // The component class\r\n      const Component = components[i];\r\n\r\n      // The view is reusable if it's an instance of the correct component\r\n      const reusable = view instanceof Component;\r\n      // Obtain an instance of the component\r\n      let instance;\r\n      if (reusable) {\r\n        instance = view;\r\n      } else {\r\n        // If a fresh instance is needed, use the component constructor\r\n        instance = new Component();\r\n        // If the fresh instance is replacing an old view,\r\n        // remove the old view\r\n        if (parent && view) {\r\n          parent.removeChild(view);\r\n        }\r\n        // Save the new instance in place of the old one\r\n        this.views[i] = instance;\r\n      }\r\n\r\n      // Create an active route based on the route and url\r\n      const active = new ActiveRoute(route, url);\r\n      instance.route = active;\r\n\r\n      // Resolve any matching parameters on the component\r\n      const parameters = active.parameters;\r\n      const properties = Component.properties;\r\n      if (properties != null) {\r\n        for (const [key, value] of parameters) {\r\n          if (properties.hasOwnProperty(key)) {\r\n            instance[key] = value;\r\n          }\r\n        }\r\n      }\r\n\r\n      // If the view wasn't reusable, it needs to be\r\n      // appended, optionally into a slot.\r\n      if (!reusable && parent != null) {\r\n        if (route.slot) {\r\n          instance.setAttribute('slot', route.slot);\r\n        }\r\n        parent.appendChild(instance);\r\n      }\r\n      parent = instance;\r\n    }\r\n\r\n    // Remove redundant views\r\n    const views = this.views;\r\n    for (let i = matched.length; i < views.length; i++) {\r\n      const view = views[i];\r\n      view.parentElement.removeChild(view);\r\n    }\r\n\r\n    // Now that the tree of components has been created,\r\n    // mount it in the DOM\r\n    if (this.root != null && this.root !== this.views[0]) {\r\n      this.target.replaceChild(this.views[0], this.root);\r\n    } else {\r\n      this.target.appendChild(this.views[0]);\r\n    }\r\n\r\n    this.root = this.views[0];\r\n    console.timeEnd('render');\r\n    this.emit();\r\n  }\r\n\r\n  emit() {\r\n    window.dispatchEvent(new Event('location-change'));\r\n  }\r\n}\r\n"],"names":["MATCH_ALL","CATCH_ALL","PARAMETER_PATTERN","MATCH_TRAILING_SLASH","WILDCARD_PATTERN","Path","[object Object]","path","exact","match","replace","keys","exec","push","endsWith","pattern","RegExp","this","test","url","ParsedExpression","current","target","values","slice","transferred","i","length","map","Map","key","indexOf","value","get","undefined","reduce","entries","Symbol","iterator","Query","object","Object","pairs","string","startsWith","substring","split","normalize","isFunction","tag","toStringTag","isNormalFunction","hasOwnProperty","isArrowFunction","isPromise","components","WeakMap","load","component","callback","customelements","has","called","then","m","set","default","Route","meta","children","super","Promise","resolve","Component","Routes","records","routes","record","define","parent","child","ActiveRoute","route","parameters","parse","matched","query","hash","location","RouterMixin","SuperClass","router","window","Router","host","getRootNode","connectedCallback","disconnectedCallback","RouterLinkElement","HTMLElement","onClick","bind","to","v","setAttribute","getAttribute","toggleAttribute","hasAttribute","active","disabled","addEventListener","onChange","removeEventListener","href","event","decodeURIComponent","pathname","EMPTY","create","console","time","views","view","render","timeEnd","data","title","history","pushState","replaceState","flatten","matches","all","import","reusable","instance","removeChild","properties","slot","appendChild","parentElement","root","replaceChild","emit","dispatchEvent","Event"],"mappings":"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"}